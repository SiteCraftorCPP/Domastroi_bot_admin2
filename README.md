# Domastroi Bot Admin - Бот-опросник для дизайн-студии

Telegram-бот для проведения опросов клиентов дизайн-студии по техническому заданию на разработку дизайн-проекта жилого помещения.

## Описание

Бот проводит опрос клиентов, собирая информацию о предпочтениях по дизайну интерьера. После завершения опроса автоматически генерируется Word-документ с результатами.

## Технологии

- Python 3
- aiogram 2.25.1
- PostgreSQL (asyncpg)
- python-docx

## Быстрый старт

### 1. Установка зависимостей

```bash
pip install -r "Bot Files/requirements.txt"
```

### 2. Настройка базы данных

Восстановите схему БД из `dump.sql`:

```bash
psql -U your_user -d your_db -f dump.sql
```

### 3. Создание файла .env

Создайте файл `.env` в папке `Bot Files/`:

```env
DB_USER=your_db_user
DB_PASSWORD=your_db_password
DB_NAME=your_db_name
DB_HOST=localhost
DB_PORT=5432
```

### 4. Настройка структуры папок

**Важно:** Бот определяет ID пользователя по названию папки, в которой запущен.

Структура должна быть такой:
```
/path/to/{USER_ID}/
├── main.py          # Копия test.py
├── questions.json   # Файл с вопросами
└── data_questions/  # Папка для сохранения документов (создается автоматически)
```

Где `{USER_ID}` - это числовой ID пользователя (например, `338566307`).

### 5. Настройка в базе данных

В таблице `users` должна быть запись с:
- `id_telegram` = ID папки (название папки)
- `bot_api` = токен бота от @BotFather
- `pay` = 1 (подписка активна)
- `date_stop` = дата окончания подписки (в будущем)

### 6. Запуск бота

```bash
cd /path/to/{USER_ID}
python main.py
```

## Структура проекта

```
Bot Files/
├── main.py              # Админ-бот (не используется для опросника)
├── test.py              # Исходный файл бота-опросника
├── questions.json       # Вопросы для опроса
├── requirements.txt     # Зависимости Python
└── user_bots/          # Папка для пользовательских ботов (создается автоматически)
    └── {USER_ID}/
        ├── main.py
        └── data_questions/
```

## Особенности

- ✅ Автоматическое сохранение прогресса опроса
- ✅ Возможность продолжить опрос с последнего вопроса
- ✅ Генерация Word-документов с результатами
- ✅ Отправка документов администратору после завершения
- ✅ Поддержка изображений в вопросах
- ✅ Кастомные текстовые ответы
- ✅ Проверка статуса подписки владельца бота

## Документация

Подробная инструкция по развертыванию на VPS: [SETUP_VPS.md](SETUP_VPS.md)

## Лицензия

Проект разработан для дизайн-студии Domastroi.
